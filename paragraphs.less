/*!  ┌─────────────────────────────────────────────────────────────────────────────────────────────┐
*    │ ++++ PARAGRAPHS +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ │
*    └─────────────────────────────────────────────────────────────────────────────────────────────┘
*/
//     ┌-----------------------------------------------------------------------------------------┐
//     │ AUTHOR: Daniel Rieck <daniel.rieck@wsu.edu> (https://github.com/invokeImmediately)      │
//     │                                                                                         │
//     │ DESCRIPTION: Contains rule-sets for styling paragraph elements within OUE pages built   │
//     │              using the WSU Spine theme for WordPress.                                   │
//     │                                                                                         │
//     │ DEPENDENCIES:                                                                           │
//     │  ╘═» This file assumes the following LESS files have been imported upstream:            │
//     │        • //github.com/invokeImmediately/WSU-UE---CSS/animations.less                    │
//     │        • //github.com/invokeImmediately/WSU-UE---CSS/color-palette.less                 │
//     │        • //github.com/invokeImmediately/WSU-UE---CSS/fonts.less                         │
//     │        • //github.com/invokeImmediately/WSU-UE---CSS/mixins.less                        │
//     └-----------------------------------------------------------------------------------------┘
//

// TODO: Add table of contents

.declare-p-rulesets(@grid-behavior) when (@grid-behavior = "hybrid") {
	p {
		// TODO: Remove when no longer needed
		& {
			.has-sectionally-responsive-font(@v-p-sz, @v-p-lnhght);
		}
/*!    ┌───────────────────────────────────────────────────────────────────────────────────────────┐
**     │ ···· OUE PARAGRAPHS §1: Legacy utility classes ·········································· │
**     └───────────────────────────────────────────────────────────────────────────────────────────┘
*/
		.column & {
			padding-bottom: 0;
			text-align: left;
			&.no-bottom-pad {
				padding-bottom: 0 !important;
			}
			&.btm-margin-override:not(:last-child) {
				margin-bottom: 0 !important;
			}
			&.double-margins:not(:last-child) {
				margin-bottom: @v-btm-mrgns * 2 !important;
			}	
			&.half-margins:not(:last-child) {
				margin-bottom: @v-btm-mrgns / 2 !important;
			}	
			&.centered {
				text-align: center !important;
			}
			&.align-left {
				text-align: left;
			}
			&.fine-print {
				.has-smllr-txt;
			}
			//TODO: make generic & move into separate file
			&.vpue-jump-bar {
				position: relative;
				padding: 0 (@v-dflt-spcng / 2) (@v-dflt-spcng / 2);
				margin: @v-dflt-spcng;
				.rgb-turquoise(); background-color: rgba(@rval,@gval,@bval,0.5);
				border: 1px solid rgba(red(@hex-dark-blue), green(@hex-dark-blue), blue(@hex-dark-blue), 0.5);
				border-radius: 10px;
				// font-size: 0.92em; // Removed as per request of MSL made on 2016-06-07
				color: @hex-darker-gray;
				text-align: center;
				box-shadow: 1px 1px 3px rgba(red(@hex-black), green(@hex-black), blue(@hex-black), 0.3);
				span.title {
					font-size: (1em / 0.92 / 0.92);
					line-height: 2em;
					font-weight: bold;
					font-variant: small-caps;
				}
				&.floating {
					display: none;
					position: fixed;
					top: 0;
					left: 50%;
					width: 50%;
					padding-top: (@v-dflt-spcng / 5);
					padding-bottom: (@v-dflt-spcng * 0.375);
					margin-top: 0;
					margin-right: 0;
					margin-left: 0;
					background-color: rgba(red(@hex-turquoise-opaque), green(@hex-turquoise-opaque), blue(@hex-turquoise-opaque), 0.95);
					font-size: (@v-p-sz * 0.8) !important;
					box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.5);
					.transform(~"translateX(-50%)");
					@media all {
						@media (max-width: @spine-threshold) {
							top: 51px;
						}
					}
					z-index: 99163;
					span.title {
						display: none;
					}
					br:first-of-type {
						display: none;
					}
					@media all {
						@media (min-width: (@spine-threshold + 1)) {
							body.admin-bar & {
								top: 32px;
							}
						}
						@media (max-width: @spine-threshold) {
							padding-bottom: ~"calc(" (@v-dflt-spcng * 0.375) ~" + 5px)";
							.transform(~"translateX(-50%) translateY(-100%) translateY(15px)");
							.transition(~"all 0.3s ease");
							&:after {
								content: "";
								position: absolute;
								left: 50%;
								bottom: 0;
								width: 0;
								height: 0;
								border-top: 5px solid @hex-darkest-gray;
								border-right: 5px solid transparent;
								border-bottom: 5px solid transparent;
								border-left: 5px solid transparent;
								.transform(~"translate(-50%, 0)");
							}
							&:hover {
								.transform(~"translateX(-50%)");
								&:after {
									border-top: 5px solid transparent;
									border-right: 5px solid transparent;
									border-bottom: 5px solid @hex-darkest-gray;
									border-left: 5px solid transparent;
									.transform(~"translate(-50%, -5px)");
								}
							}
						}
					}
				}
			}
			// TODO: Distribute border image code to custom *.LESS files for each WSU-UE website ■
			&.banner-text-gray-with-towers {
				color: @hex-darkest-gray;
				background-color: rgba(141,149,154,0.5);
				border: 32px solid transparent;
				-webkit-border-image: url(/wp-content/uploads/sites/906/2015/08/Gray-Clock-Tower-Border-Template.png) 32 32 round;
				-o-border-image: url(/wp-content/uploads/sites/906/2015/08/Gray-Clock-Tower-Border-Template.png) 32 32 round;
				border-image: url(/wp-content/uploads/sites/906/2015/08/Gray-Clock-Tower-Border-Template.png) 32 32 round;
				margin-bottom: 15px;
				padding: 7px;
				@media all {
					@media (min-width: @large-format-threshold) {
						font-size: @v-bnnr-txt-sz;
					}
					@media (max-width: (@large-format-threshold - 1)) {
						font-size: @v-bnnr-txt-sz * @v-scl-dwn;
					}
				}
			}
			&.banner-text {
				padding: 7px;
				.margin-centered;
				 margin-bottom: @v-dflt-spcng;
				.rgb-dark-gray(); background-color: rgba(@rval, @gval, @bval, 0.5);
				border: 1px solid @hex-darkest-gray;
				line-height: @v-p-lnhght;
				color: @hex-darkest-gray;
				.has-responsive-font(@v-bnnr-txt-sz, @v-p-lnhght);
				&.orange {
					.rgb-orange(); background-color: rgba(@rval, @gval, @bval, 0.5);
					border: 1px solid @hex-darkest-orange;
				}
				&.blue {
					background-color: rgba(red(@hex-accent-blue), green(@hex-accent-blue), blue(@hex-accent-blue), 0.3);
					border: 1px solid @hex-darkest-blue;
				}
				&.yellow {
					.rgb-yellow(); background-color: rgba(@rval, @gval, @bval, 0.5);
					border: 1px solid @hex-darkest-yellow;
				}
				&.green {
					.rgb-green(); background-color: rgba(@rval, @gval, @bval, 0.5);
					border: 1px solid @hex-darkest-green;
				}
			}
			// TODO: Distribute border image code to custom *.LESS files for each WSU-UE website ■
			&.banner-text-orange-with-towers {
				padding: 7px;
				margin-bottom: 15px;
				border: 32px solid transparent;
				color: @hex-darkest-orange;
				.rgb-orange(); background-color: rgba(@rval,@gval,@bval,0.5);
				 -webkit-border-image: url(/wp-content/uploads/sites/50/2015/09/Orange-Clock-Tower-Border-Template-v3.png) 32 32 round;
				 -o-border-image: url(/wp-content/uploads/sites/50/2015/09/Orange-Clock-Tower-Border-Template-v3.png) 32 32 round;
				border-image: url(/wp-content/uploads/sites/50/2015/09/Orange-Clock-Tower-Border-Template-v3.png) 32 32 round;
				.has-responsive-font(@v-bnnr-txt-sz, @v-p-lnhght);
			}
		}
		// TODO: make generic & move into separate file
		&.article-deck {
			.has-sectionally-responsive-font(@v-artcl-deck-sz, @v-p-lnhght);
			.column & {
				color: @hex-dark-green;
				strong {
					color: @hex-green;
				}
			}
		}
		// TODO: make generic & move into separate file
		&.article-tagline {
			.has-sectionally-responsive-font(@v-artcl-tgln-sz, @v-p-lnhght);
			&.home {
				.has-sectionally-responsive-font((@v-artcl-tgln-sz * 1.310345), @v-p-lnhght);
			}
			.column & {
				.has-subst-font.serif;
				font-size: @v-artcl-tgln-sz;
				line-height: @v-artcl-tgln-lnhght;
				font-weight: @v-artcl-tgln-wght;
			}
			.column &.sans {
				&:extend(.has-alt-font);
				color: @hex-black;
				font-weight: 300;
				// letter-spacing: 0.5px; // Removed on 2016-06-10 to improve readability of text.
				& > span.lead-in {
					color: @hex-dark-blue;
					font-weight: 700;
					letter-spacing: normal;                    
				}
			}
			&:not(.has-no-bordering) {
				.has-pull-quote-bordering(@hex-darker-gray);
				&:not(.alt) {
					.column h1 + &,
					.column h2 + &,
					.column h3 + &,
					.column h4 + &,
					.column h5 + &,
					.column h6 + & {
						margin-top: (@v-btm-mrgns * 4 / 3);
					}
				}
				&.crimson {
					.has-pull-quote-bordering(@hex-crimson);
					color: @hex-crimson;
					.has-gray-text {
						color: @hex-darker-gray;
					}
				}
			}
			&.bold,
			.has-bold-text {
				font-weight: bold;
			}
		}
		&.vpue-jump-back {
			.has-sectionally-responsive-font(@v-p-jmpbck-sz, @v-p-lnhght);
			.column & {
				padding-bottom: @v-btm-pads / 3;
				margin-bottom: @v-btm-mrgns / 3;
			}
		}
		&.article-media-contacts {
			.has-sectionally-responsive-font(0.8rem, @v-p-lnhght);
			.column & {
				padding-left: 2em;
				text-align: left;
				&:first-child {
					margin-top: @v-btm-mrgns;
				}
			}
			body.single-post .column & + :not(.article-media-contacts) {
				padding-top: 15px;
				border-top: 1px solid rgba(127,127,127,0.2);
			}
		}
	}
	.use-jumpbar-icons(@icon-url) when (isurl(@icon-url)) {
		.column p.vpue-jump-bar {
			padding-left: 33px;
			&:before {
				content: "";
				position: absolute;
				left: 0;
				top: 0;
				height: 100%;
				width: 25px;
				background: #2d95a5 @icon-url left center/24px 24px no-repeat;
				border-top-left-radius: 10px;
				border-bottom-left-radius: 10px;
			}
			&.floating {
				@media all and (max-width: @spine-threshold) {
					&:before {
						background-position: left bottom;
					}
					&:hover {
						&:before {
							background-position: left center;
						}
					}
				}
			}
		}
	}
}
.declare-p-rulesets(@grid-behavior);

/*!    ┌───────────────────────────────────────────────────────────────────────────────────────────┐
**     │ ···· OUE PARAGRAPHS §2: Paragraph based notices ········································· │
**     └───────────────────────────────────────────────────────────────────────────────────────────┘
*/
.use-paragraph-notices(@icon-url) when (isurl(@icon-url)) {
	.column p.notice {
		position: relative;
		width: 80%;
		width: ~"calc(90% - 2 * @{v-btm-mrgns} - 32px)";
		padding: @v-btm-mrgns;
		padding-right: ~"calc(@{v-btm-mrgns} + 32px)";
		margin-left: auto;
		margin-right: auto;
		&{ background-color: @rgba; .getRgbaStr(@hex-light-crimson, 0.2); }
		border-radius: 10px;
		&:before {
			content: "";
			position: absolute;
			top: 0;
			right: 0;
			bottom: 0;
			width: 32px;
			border-top-right-radius: 10px;
			border-bottom-right-radius: 10px;
			&{ background: @rgba @icon-url 4px @v-btm-mrgns no-repeat; .getRgbaStr(@hex-crimson, 0.3333); }
		}
		&.linked {
			a {
				display: none;
				&:first-of-type {
					display: block;
					position: absolute;
					top: 0;
					left: 0;
					height: 100%;
					width: 100%;
					border-bottom: none;
					border-radius: 10px;
					background-blend-mode: multiply;
					color: transparent;
					box-shadow: none;
					z-index: 1;
					&:hover {
						background-color: rgba(red(@hex-white), green(@hex-white), blue(@hex-white), 0.33);
						text-shadow: none;
						.transition(~"all 0.3s linear");
					}
				}
			}
			.hyperlink-simulator {
				border-bottom-right-radius: 0.25em;
				border-bottom-left-radius: 0.25em;
				border-bottom: 0.0625em solid rgba(red(@hex-crimson), green(@hex-crimson), blue(@hex-crimson), 1);
				box-shadow: inset 0 -0.3125em 0 rgba(red(@hex-crimson), green(@hex-crimson), blue(@hex-crimson), .15);
				color: @hex-crimson;
			}
		}
	}
	.add-download-notice(@download-notice-bg-clr, @download-notice-stripe-clr, @download-icon-url) when
		(iscolor(@download-notice-bg-clr)) and (iscolor(@download-notice-stripe-clr)) and (isurl(@download-icon-url)) {
		.column p.notice.download {
			background-color: @download-notice-bg-clr;
			&:before {
				background: @download-notice-stripe-clr @download-icon-url 4px @v-btm-mrgns no-repeat;
			}		
		}
	}
	.add-new-notice-class(@new-notice-class, @new-notice-bg-clr, @new-notice-stripe-clr, @new-notice-icon-url,
			@stripe-width: 32px, @icon-width: 24px, @icon-top-margin: @v-btm-mrgns) when (iscolor(@new-notice-bg-clr)) and
			(iscolor(@new-notice-stripe-clr)) and (isurl(@new-notice-icon-url)) and (ispixel(@stripe-width)) and
			(ispixel(@icon-width)) and (isnumber(@icon-top-margin)) {
		.column p.notice.@{new-notice-class} {
			background-color: @new-notice-bg-clr;
			padding-right: ~"calc(@{v-btm-mrgns} + @{stripe-width})";
			&:before {
				width: @stripe-width;
				@icon-spacing: (@stripe-width - @icon-width) / 2;
				background: @new-notice-stripe-clr @new-notice-icon-url @icon-spacing @icon-top-margin no-repeat;
			}
		}
	}
}

/*!    ┌───────────────────────────────────────────────────────────────────────────────────────────┐
**     │ ···· OUE PARAGRAPHS §3: Accessibility friendly classes ·································· │
**     └───────────────────────────────────────────────────────────────────────────────────────────┘
*/

@p--parent: ~"body.use-a11y-stlyes .column";

/*!      >>> ···· §3.1, Accessibility friendly classes: Typograhy ··························· <<< */

// §3.1a: LESS variables

@p--lHeight-1: 1.25em;
@p--lHeight-2: 1.375em;
@p--lHeight-3: 1.5em;
@p--lHeight-array: @p--lHeight-1, @p--lHeight-2, @p--lHeight-3;

// §3.1b: Defaults

p {
	@{p--parent} & {
		max-width: 80ch;
		font-size: @v-p-sz;
		line-height: @p--lHeight-3;
	}
}

// §3.1c: Utility classes
p {
	@{p--parent} & {	
		.p--lHeight-loop(@idx, @heights) when (@idx > 0) 
				and (@idx <= length(@heights)) {
			.p--lHeight-loop((@idx - 1), @heights);
			&.p--lHeight-@{idx} {
				line-height: extract(@heights, @idx);
			}
		}
		.p--lHeight-loop(length(@p--lHeight-array), @p--lHeight-array);
	}
}
